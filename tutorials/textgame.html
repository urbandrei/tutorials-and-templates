<!-- SPECIAL THANKS TO OUR KOFI SUPPORTERS
Michael Thompson
Rajesh
Shudokuso_
Zek
-->
<html>
<head>
<style>
</style>
<script>
function remove(id) {
	document.getElementById(id).remove();
}

function appendP(text) {
	const newtext = document.createElement("p");
	newtext.innerHTML = text;
	document.body.appendChild(newtext);
}

function appendButton(id, text) {
	const but = document.createElement("button");
	but.id = id;
	but.innerHTML = text;
	document.body.appendChild(but);
	return but;
}

let key = false;
let escaped = false;
let roomId = 1;
const rooms = {
	1: {
		buttons: {
			"Try the door.": () => {
				if (key) {
					appendP("You escaped the room!");
					escaped = true;
				} else {
					appendP("The door is locked!");
				}
				return !escaped;
			},
			"Look around.": () => {
				if (key) {
					appendP("You find nothing.");
				} else {
					appendP("You find a key!");
					key = true;
				}
				return true;
			}
		}
	}
};

window.onload = () => {
	appendP("You are in a dark room.");
	function recurse() {
		const room = rooms[roomId];
		let butId = 0;
		for (let [k, v] of Object.entries(room.buttons)) {
			console.log(k, v);
			let but = appendButton(butId, k);
			butId += 1;
			but.onclick = () => {
				butId = 0;
				for (let [k, v] of Object.entries(room.buttons)) {
					remove(butId++);
				}
				if (v()) {
					recurse();
				}
			}
		}
	}
	recurse();
}
</script>
</head>
<body>
</body>
</html>
